# full atom 3-propargyl sugar patch
# partial charges from charm 27

NAME 3-propargyl
TYPES O3_PROPARGYL_SUGAR

BEGIN_SELECTOR
PROPERTY CARBOHYDRATE
NOT UPPER_ATOM O3
NOT VARIANT_TYPE C3_BRANCH_POINT
NOT PROPERTY C3_MODIFIED
END_SELECTOR

BEGIN_CASE

# Making the H invisible
SET_ATOM_TYPE HO3 VIRT
SET_MM_ATOM_TYPE HO3 VIRT
SET_ATOMIC_CHARGE HO3 0.00

# Change the oxygen atom type
SET_ATOM_TYPE O3 OOC
SET_MM_ATOM_TYPE O3 OS
SET_ATOMIC_CHARGE O3 -0.26

# Add new atoms!
ADD_ATOM  CO3 CH2 CT2 -0.05
ADD_ATOM 1HC3 Hapo HA 0.09
ADD_ATOM 2HC3 Hapo HA 0.09
ADD_ATOM CCO3 aroC CA 0.00  # not the right atom type, but only option we have right now.
ADD_ATOM CCC3 aroC CA 0.00  # not the right atom type, but only option we have right now.
ADD_ATOM HCC3 Hpol H  0.00

#Add new bonds
ADD_BOND  O3   CO3
ADD_BOND  CO3 1HC3
ADD_BOND  CO3 2HC3
ADD_BOND  CO3 CCO3
ADD_BOND_TYPE CCO3 CCC3 TRIPLE
ADD_BOND CCC3 HCC3

#ADD rotamer
ADD_CHI N+1 C3 O3 CO3 CCO3
ADD_CHI_ROTAMER N  -30 0
ADD_CHI_ROTAMER N  180 0
ADD_CHI_ROTAMER N   60 0

SET_ICOOR  CO3  -60.0  63.4  1.45  O3   C3   C2
SET_ICOOR 1HC3   60.0  70.1  1.10  CO3  O3   C3
SET_ICOOR 2HC3  -60.0  70.1  1.10  CO3  O3   C3
SET_ICOOR CCO3  180.0  70.2  1.47  CO3  O3   C3
SET_ICOOR CCC3  120.0   0.0  1.21 CCO3  CO3  O3
SET_ICOOR HCCC    0.0   0.0  1.02 CCC3 CCO3  CO3

ADD_PROPERTY C3_MODIFIED
ADD_PROPERTY PROPARGYL_SUGAR

END_CASE
