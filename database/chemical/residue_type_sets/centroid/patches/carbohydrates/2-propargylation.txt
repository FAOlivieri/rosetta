# full atom 2-propargyl sugar patch
# partial charges from charm 27

NAME 2-propargyl
TYPES O2_PROPARGYL_SUGAR

BEGIN_SELECTOR
PROPERTY CARBOHYDRATE
NOT UPPER_ATOM O2
NOT VARIANT_TYPE C2_BRANCH_POINT
NOT PROPERTY C2_MODIFIED
END_SELECTOR

BEGIN_CASE

# Making the H invisible
SET_ATOM_TYPE HO2 VIRT
SET_MM_ATOM_TYPE HO2 VIRT
SET_ATOMIC_CHARGE HO2 0.00

# Change the oxygen atom type
SET_ATOM_TYPE O2 OOC
SET_MM_ATOM_TYPE O2 OS
SET_ATOMIC_CHARGE O2 -0.26

# Add new atoms!
ADD_ATOM  CO2 CH2 CT2 -0.05
ADD_ATOM 1HC2 Hapo HA 0.09
ADD_ATOM 2HC2 Hapo HA 0.09
ADD_ATOM CCO2 aroC CA 0.00  # not the right atom type, but only option we have right now.
ADD_ATOM CCC2 aroC CA 0.00  # not the right atom type, but only option we have right now.
ADD_ATOM HCC2 Hpol H  0.00

#Add new bonds
ADD_BOND  O2   CO2
ADD_BOND  CO2 1HC2
ADD_BOND  CO2 2HC2
ADD_BOND  CO2 CCO2
ADD_BOND_TYPE CCO2 CCC2 TRIPLE
ADD_BOND CCC2 HCC2

#ADD rotamer
ADD_CHI N+1 C2 O2 CO2 CCO2
ADD_CHI_ROTAMER N  120 0
ADD_CHI_ROTAMER N  180 0

SET_ICOOR  CO2  -60.0  63.4  1.45  O2   C2   C1
SET_ICOOR 1HC2   60.0  70.1  1.10  CO2  O2   C2
SET_ICOOR 2HC2  -60.0  70.1  1.10  CO2  O2   C2
SET_ICOOR CCO2  180.0  70.2  1.47  CO2  O2   C2
SET_ICOOR CCC2  120.0   0.0  1.21 CCO2  CO2  O2
SET_ICOOR HCC2    0.0   0.0  1.02 CCC2 CCO2  CO2

ADD_PROPERTY C2_MODIFIED
ADD_PROPERTY PROPARGYL_SUGAR

END_CASE
