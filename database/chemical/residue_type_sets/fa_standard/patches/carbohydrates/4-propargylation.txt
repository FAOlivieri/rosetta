# full atom 4-propargyl sugar patch
# partial charges from charm 27

NAME 4-propargyl
TYPES O4_PROPARGYL_SUGAR

BEGIN_SELECTOR
PROPERTY CARBOHYDRATE
NOT UPPER_ATOM O4
NOT VARIANT_TYPE C4_BRANCH_POINT
NOT PROPERTY C4_MODIFIED
END_SELECTOR

BEGIN_CASE

# Making the H invisible
SET_ATOM_TYPE HO4 VIRT
SET_MM_ATOM_TYPE HO4 VIRT
SET_ATOMIC_CHARGE HO4 0.00

# Change the oxygen atom type
SET_ATOM_TYPE O4 OOC
SET_MM_ATOM_TYPE O4 OS
SET_ATOMIC_CHARGE O4 -0.26

# Add new atoms!
ADD_ATOM  CO4 CH2 CT2 -0.05
ADD_ATOM 1HC4 Hapo HA 0.09
ADD_ATOM 2HC4 Hapo HA 0.09
ADD_ATOM CCO4 aroC CA 0.00  # not the right atom type, but only option we have right now.
ADD_ATOM CCC4 aroC CA 0.00  # not the right atom type, but only option we have right now.
ADD_ATOM HCC4 Hpol H  0.00

#Add new bonds
ADD_BOND  O4   CO4
ADD_BOND  CO4 1HC4
ADD_BOND  CO4 2HC4
ADD_BOND  CO4 CCO4
ADD_BOND_TYPE CCO4 CCC4 TRIPLE
ADD_BOND CCC4 HCC4

#Add rotamer
ADD_CHI N+1 C4 O4 CO4 CCO4
ADD_CHI_ROTAMER N   60 0
ADD_CHI_ROTAMER N  180 0
ADD_CHI_ROTAMER N  -60 0

SET_ICOOR  CO4  -60.0  63.4  1.45  O4   C4   C3
SET_ICOOR 1HC4   60.0  70.1  1.10  CO4  O4   C4
SET_ICOOR 2HC4  -60.0  70.1  1.10  CO4  O4   C4
SET_ICOOR CCO4  180.0  70.2  1.47  CO4  O4   C4
SET_ICOOR CCC4  120.0   0.0  1.21 CCO4  CO4  O4
SET_ICOOR HCC4    0.0   0.0  1.02 CCC4 CCO4  CO4

ADD_PROPERTY C4_MODIFIED
ADD_PROPERTY PROPARGYL_SUGAR

END_CASE
